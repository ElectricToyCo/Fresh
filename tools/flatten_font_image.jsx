function cleanup(){    // Restore the document state to when it was opened.    try    {        var doc = app.activeDocument;        doc.activeHistoryState = doc.historyStates[ 0 ];        app.purge( PurgeTarget.HISTORYCACHES );    }    catch( e )    {}}var startRulerUnits = app.preferences.rulerUnits;var startTypeUnits = app.preferences.typeUnits;var startDisplayDialogs = app.displayDialogs;app.preferences.rulerUnits = Units.PIXELS;app.preferences.typeUnits = TypeUnits.PIXELS;app.displayDialogs = DialogModes.NO;var doc = app.activeDocument;// Make the canvas 16x wider.var originalWidth = doc.width;var extendedWidth = originalWidth * 16;var originalHeight = doc.height;doc.resizeCanvas( extendedWidth, originalHeight, AnchorPosition.MIDDLELEFT );var selection = doc.selection;for( var x = 0; x < 15; ++x ){    var left  =    x         * originalWidth;    var right = ( x + 1 ) * originalWidth - 1;    var top = originalHeight / 16.0;    var bottom = originalHeight - 1;        var points = [ [left, top], [right, top], [right, bottom], [left, bottom] ];        selection.select( points );        selection.translate( originalWidth, originalHeight / -16.0 );}selection.deselect();doc.resizeCanvas( extendedWidth, originalHeight / 16, AnchorPosition.TOPCENTER );// Reset the application preferences//cleanup();app.preferences.rulerUnits = startRulerUnits;app.preferences.typeUnits = startTypeUnits;app.displayDialogs = startDisplayDialogs;