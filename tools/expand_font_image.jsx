function cleanup(){    // Restore the document state to when it was opened.    try    {        var doc = app.activeDocument;        doc.activeHistoryState = doc.historyStates[ 0 ];        app.purge( PurgeTarget.HISTORYCACHES );    }    catch( e )    {}}var startRulerUnits = app.preferences.rulerUnits;var startTypeUnits = app.preferences.typeUnits;var startDisplayDialogs = app.displayDialogs;app.preferences.rulerUnits = Units.PIXELS;app.preferences.typeUnits = TypeUnits.PIXELS;app.displayDialogs = DialogModes.NO;var doc = app.activeDocument;// Make the canvas 16x wider.var originalWidth = doc.width;var narrowedWidth = originalWidth / 16;var originalHeight = doc.height;var expandedHeight = doc.height * 16;doc.resizeCanvas( originalWidth, expandedHeight, AnchorPosition.TOPCENTER );var selection = doc.selection;for( var x = 0; x < 15; ++x ){    var left  =    ( x + 1 ) * narrowedWidth;    var right = left + narrowedWidth - 1;    var top = 0;    var bottom = originalHeight;        var points = [ [left, top], [right, top], [right, bottom], [left, bottom] ];        selection.select( points );            var selectionBounds = selection.bounds;    try    {        selection.translate( -left, ( x + 1 ) * originalHeight );    }    catch( e )    {}}selection.deselect();doc.resizeCanvas( narrowedWidth, expandedHeight, AnchorPosition.MIDDLELEFT );// Reset the application preferences//cleanup();app.preferences.rulerUnits = startRulerUnits;app.preferences.typeUnits = startTypeUnits;app.displayDialogs = startDisplayDialogs;